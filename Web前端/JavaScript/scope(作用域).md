# 作用域与作用域链

## 作用域

作用域指的是变量存在的范围。在JavaScript中只有2种作用域：**全局作用域**，**函数作用域**。

全局作用域：由script标签产生的区域，从计算机的角度可以理解为window对象。变量在整个程序中一直存在，所有地方都可以读取。

函数作用域：由函数产生的区域，从计算机的角度可以理解为AO对象。变量只在函数内部存在。

ES6新增**块级作用域**。

## 作用域链

在js中，函数存在一个隐式属性[[scopes]]，这个属性用来保存当前函数在执行时的环境(上下文)，由于在数据结构上是链式的，也称为作用域链。可以理解成一个数组。

[[scopes]]属性在函数声明时产生，在函数调用时更新。

[[scopes]]属性记录当前函数的执行环境。

在函数被调用时，该函数的AO对象压入到[[scopes]]中。

```javascript
function a() {
  function b() {
    function c() {}
    c();
  }
  b();
}
a();

1. 产生a函数的AO对象，aAO。
   函数a的scopes：
                0：aAO={b: fun}
                1：GO

2. 产生b函数的AO对象，bAO。
   函数b的scopes：
                0：bAO={c: fun}
                1：aAO={b: fun}
                2：GO
...
```

## 作用域链的作用

在访问变量或函数时，会在作用域链上依次查找，最直观的表现是：内部函数可以使用外部函数声明的变量。
